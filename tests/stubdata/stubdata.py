# -*- coding: utf-8 -*-
from collections import OrderedDict

GENERAL=OrderedDict([(u'@origin', u'AAS'), (u'@type', u'general'), (u'@primary', u'True'), (u'@alternate_journal', u'False'), (u'creation_time', u'2012-08-06T19:12:47'), (u'modification_time', u'2012-08-06T19:12:47'), (u'bibcode', u'2010AAS...21542816H'), (u'dates', OrderedDict([(u'date', OrderedDict([(u'@type', u'date-published'), ('#text', u'2010-01-00')]))])), (u'title', u'Characteristics Of Hydrocarbon Emission From Herbig Ae/be Stars'), (u'abstract', u'We present analysis of polycyclic aromatic hydrocarbon (PAH) emission in mid-infrared spectra of a large sample of Herbig Ae and Be (HAeBe) stars. The spectra were obtained with the Infrared Spectrograph on the Spitzer Space Telescope. In a previous study of 18 HAeBe stars we found: evidence that the PAH ionization fraction in the circumstellar material around HAeBe stars is related to the structure of the PAH molecules; that the center wavelengths of the PAH emission features change systematically with stellar effective temperature changes; and that HAeBe stars have may have unique mid-infrared spectral characteristics that distinguish them from other strong PAH emission sources. We also found no simple correlation between the integrated intensity of PAH emission from HAeBe stars and the geometry of their proto-planetary disks. We now have expanded the sample to include 50 stars using archival data from the Spitzer database. We present a similar analysis applied to the larger sample.'), (u'author', [OrderedDict([(u'@nr', u'1'), (u'name', OrderedDict([(u'western', u'Hyatt, Jordan'), (u'normalized', u'Hyatt, J')])), (u'affiliations', OrderedDict([(u'affiliation', u'Ithaca College')])), (u'type', u'regular')]), OrderedDict([(u'@nr', u'2'), (u'name', OrderedDict([(u'western', u'Keller, L. D.'), (u'normalized', u'Keller, L')])), (u'affiliations', OrderedDict([(u'affiliation', u'Ithaca College')])), (u'type', u'regular')]), OrderedDict([(u'@nr', u'3'), (u'name', OrderedDict([(u'western', u'Sloan, G. C.'), (u'normalized', u'Sloan, G')])), (u'affiliations', OrderedDict([(u'affiliation', u'Cornell University')])), (u'type', u'regular')]), OrderedDict([(u'@nr', u'4'), (u'name', OrderedDict([(u'western', u'Geidel, K. L.'), (u'normalized', u'Geidel, K')])), (u'affiliations', OrderedDict([(u'affiliation', u'Ithaca College')])), (u'type', u'regular')])]), (u'ADSaffiliation', u'AA(Ithaca College), AB(Ithaca College), AC(Cornell University), AD(Ithaca College)'), (u'journal', u'American Astronomical Society, AAS Meeting #215, #428.16; <ALTJOURNAL>Bulletin of the American Astronomical Society, Vol. 42, p.347</ALTJOURNAL>'), (u'canonical_journal', u'American Astronomical Society Meeting Abstracts #215'), (u'electronic_id', u'428.16'), (u'publication_year', u'2010'), (u'volume', u'215')])
PROPERTIES=OrderedDict([(u'@origin', u'ADS metadata'), (u'vizier_tables', OrderedDict([(u'vizier_table', [u'Galaxies', u'HII regions', u'Optical'])])), (u'@type', u'properties'), (u'@primary', u'False'), (u'@alternate_journal', u'False'), (u'JSON_timestamp', u'{"abs":[{"p":"/proj/ads/abstracts/ast/text/A85/A85-29431.abs","primary":1,"t":"1386214979"},{"p":"/proj/ads/abstracts/ast/text/J85/J85-29431.abs","t":"1321421644"},{"p":"/proj/ads/abstracts/ast/text/S85/S85-29431.abs","t":"1347305751"}],"full":[{"p":"/proj/ads/fulltext/extracted/19/85/A&/A,/,,/14/2,/,,/,1/K//meta.json","t":1395490755},{"p":"/proj/ads/fulltext/extracted/19/85/A&/A,/,,/14/2,/,,/,1/K//fulltext.txt","t":1363068221}],"links":{"associated":[{"t":"Part  1","u":"1983IAUS..100...99V"},{"t":"Part  2","u":"1984A&A...133..127K"},{"t":"Part  3","u":"1985A&A...142....1K"},{"t":"Part  4","u":"1985A&A...144..202K"},{"t":"Part  5","u":"1988A&A...191..201V"},{"t":"Part  6","u":"1988A&A...199...41V"},{"t":"Part  7","u":"1988A&A...204...39V"},{"t":"Part  8","u":"1989A&A...218...49V"},{"t":"Part  9","u":"1989A&A...225..317V"},{"t":"Part 11","u":"1991A&A...243...71V"},{"t":"Part 10","u":"1993A&A...269...15V"}],"ned":[{"c":"1","u":"http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K"}]},"prop":["article","refereed"],"refs":[{"p":"/proj/ads/references/resolved/A&A/0142/1985A&A...142....1K.ref.ocr.txt.result","t":1374509778},{"p":"/proj/ads/references/resolved/ISI/A&A/A&A0142.isi.pairs.result","t":1302279738}]}'), (u'databases', OrderedDict([(u'database', u'AST')])), (u'data_sources', OrderedDict([(u'data_source', u'NED')])), (u'pubtype', u'article'), (u'refereed', u'1'), (u'openaccess', u'1'), (u'pub_openaccess', u'0'), (u'private', u'0'), (u'ocrabstract', u'0'), (u'ads_openaccess', u'1'), (u'eprint_openaccess', u'0'), (u'preprint', None), (u'nonarticle', u'0'), (u'associates', OrderedDict([(u'associate', [OrderedDict([(u'@comment', u'Part  1'), ('#text', u'1983IAUS..100...99V')]), OrderedDict([(u'@comment', u'Part  2'), ('#text', u'1984A&A...133..127K')]), OrderedDict([(u'@comment', u'Part  3'), ('#text', u'1985A&A...142....1K')]), OrderedDict([(u'@comment', u'Part  4'), ('#text', u'1985A&A...144..202K')]), OrderedDict([(u'@comment', u'Part  5'), ('#text', u'1988A&A...191..201V')]), OrderedDict([(u'@comment', u'Part  6'), ('#text', u'1988A&A...199...41V')]), OrderedDict([(u'@comment', u'Part  7'), ('#text', u'1988A&A...204...39V')]), OrderedDict([(u'@comment', u'Part  8'), ('#text', u'1989A&A...218...49V')]), OrderedDict([(u'@comment', u'Part  9'), ('#text', u'1989A&A...225..317V')]), OrderedDict([(u'@comment', u'Part 11'), ('#text', u'1991A&A...243...71V')]), OrderedDict([(u'@comment', u'Part 10'), ('#text', u'1993A&A...269...15V')])])]))])
REFERENCES=OrderedDict([(u'@origin', u'ISI'), (u'@source', u'A&A0142.isi.pairs'), (u'@type', u'references'), (u'@primary', u'False'), (u'@alternate_journal', u'False'), (u'creation_time', u'2011-04-08T16:22:18'), (u'modification_time', u'2011-04-08T16:22:18'), (u'reference', [OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1981A&A....98..251B'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1981A&A....98..251B')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1981ApJ...246..666T'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1981ApJ...246..666T')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1981ApJ...246L.105H'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1981ApJ...246L.105H')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1981MNRAS.196..747H'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1981MNRAS.196..747H')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1982A&A...114..400H'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1982A&A...114..400H')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1982ApJ...252..125T'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1982ApJ...252..125T')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1982ApJ...256..460K'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1982ApJ...256..460K')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1982ApJ...258...64A'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1982ApJ...258...64A')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1983MNRAS.202...37S'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1983MNRAS.202...37S')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1983MNRAS.202.1001B'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1983MNRAS.202.1001B')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1984A&A...141..309B'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1984A&A...141..309B')]), OrderedDict([(u'@origin', u'ISI'), (u'@bibcode', u'1984MNRAS.208..111S'), (u'@score', u'1'), (u'@arxid', u''), (u'@doi', u''), ('#text', u'1984MNRAS.208..111S')])])])
RELATIONS=OrderedDict([(u'@origin', u'ADS metadata'), (u'@type', u'relations'), (u'@primary', u'False'), (u'@alternate_journal', u'False'), (u'alternates', None), (u'links', OrderedDict([(u'link', [OrderedDict([(u'@url', u'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K'), (u'@count', u'1'), (u'@type', u'ned')]), OrderedDict([(u'@url', u'http://adsabs.harvard.edu/abs/1985A%26A...142....1K'), (u'@type', u'ADSlink')])])]))])

GENERAL_ENFORCED={'comment': [], 'doi': [], 'publication': {'origin': u'AAS', 'dates': [{'content': u'2010-01-00', 'type': u'date-published'}, {'content': u'2010', 'type': 'publication_year'}], 'name': {'raw': u'American Astronomical Society, AAS Meeting #215, #428.16; <ALTJOURNAL>Bulletin of the American Astronomical Society, Vol. 42, p.347</ALTJOURNAL>', 'canonical': u'American Astronomical Society Meeting Abstracts #215'}, 'page_count': None, 'page_last': None, 'volume': u'215', 'page_range': None, 'electronic_id': u'428.16', 'altbibcode': u'2010AAS...21542816H', 'issue': None, 'page': None}, 'language': '', 'tempdata': {'origin': u'AAS', 'modtime': u'2012-08-06T19:12:47', 'type': u'general', 'primary': True, 'alternate_journal': False}, 'issns': [], 'conf_metadata': {'origin': u'AAS', 'content': None}, 'titles': [{'lang': u'en', 'text': u'Characteristics Of Hydrocarbon Emission From Herbig Ae/be Stars'}], 'isbns': [], 'authors': [{'name': {'western': u'Hyatt, Jordan', 'normalized': u'Hyatt, J', 'native': None}, 'number': u'1', 'affiliations': [u'Ithaca College'], 'orcid': None, 'type': u'regular', 'emails': []}, {'name': {'western': u'Keller, L. D.', 'normalized': u'Keller, L', 'native': None}, 'number': u'2', 'affiliations': [u'Ithaca College'], 'orcid': None, 'type': u'regular', 'emails': []}, {'name': {'western': u'Sloan, G. C.', 'normalized': u'Sloan, G', 'native': None}, 'number': u'3', 'affiliations': [u'Cornell University'], 'orcid': None, 'type': u'regular', 'emails': []}, {'name': {'western': u'Geidel, K. L.', 'normalized': u'Geidel, K', 'native': None}, 'number': u'4', 'affiliations': [u'Ithaca College'], 'orcid': None, 'type': u'regular', 'emails': []}], 'keywords': [], 'arxivcategories': [], 'pubnote': [], 'copyright': [], 'abstracts': [{'lang': u'en', 'text': u'We present analysis of polycyclic aromatic hydrocarbon (PAH) emission in mid-infrared spectra of a large sample of Herbig Ae and Be (HAeBe) stars. The spectra were obtained with the Infrared Spectrograph on the Spitzer Space Telescope. In a previous study of 18 HAeBe stars we found: evidence that the PAH ionization fraction in the circumstellar material around HAeBe stars is related to the structure of the PAH molecules; that the center wavelengths of the PAH emission features change systematically with stellar effective temperature changes; and that HAeBe stars have may have unique mid-infrared spectral characteristics that distinguish them from other strong PAH emission sources. We also found no simple correlation between the integrated intensity of PAH emission from HAeBe stars and the geometry of their proto-planetary disks. We now have expanded the sample to include 50 stars using archival data from the Spitzer database. We present a similar analysis applied to the larger sample.', 'origin': u'AAS'}]}
PROPERTIES_ENFORCED={'refereed': True, 'openaccess': True, 'data_sources': [{'origin': u'ADS metadata', 'content': u'NED'}], 'tempdata': {'origin': u'ADS metadata', 'modtime': None, 'type': u'properties', 'primary': False, 'alternate_journal': False}, 'doctype': {'origin': u'ADS metadata', 'content': u'article'}, 'private': False, 'ads_openaccess':True, 'eprint_openaccess': False, 'pub_openaccess': False, 'ocrabstract': False, 'associates': [{'origin': u'ADS metadata', 'comment': u'Part  1', 'content': u'1983IAUS..100...99V'}, {'origin': u'ADS metadata', 'comment': u'Part  2', 'content': u'1984A&A...133..127K'}, {'origin': u'ADS metadata', 'comment': u'Part  3', 'content': u'1985A&A...142....1K'}, {'origin': u'ADS metadata', 'comment': u'Part  4', 'content': u'1985A&A...144..202K'}, {'origin': u'ADS metadata', 'comment': u'Part  5', 'content': u'1988A&A...191..201V'}, {'origin': u'ADS metadata', 'comment': u'Part  6', 'content': u'1988A&A...199...41V'}, {'origin': u'ADS metadata', 'comment': u'Part  7', 'content': u'1988A&A...204...39V'}, {'origin': u'ADS metadata', 'comment': u'Part  8', 'content': u'1989A&A...218...49V'}, {'origin': u'ADS metadata', 'comment': u'Part  9', 'content': u'1989A&A...225..317V'}, {'origin': u'ADS metadata', 'comment': u'Part 11', 'content': u'1991A&A...243...71V'}, {'origin': u'ADS metadata', 'comment': u'Part 10', 'content': u'1993A&A...269...15V'}], 'databases': [{'origin': u'ADS metadata', 'content': u'AST'}], 'vizier_tables': [{'origin': u'ADS metadata', 'content': u'Galaxies'}, {'origin': u'ADS metadata', 'content': u'HII regions'}, {'origin': u'ADS metadata', 'content': u'Optical'}], 'bibgroups': []}
REFERENCES_ENFORCED={'tempdata': {'modtime': u'2011-04-08T16:22:18', 'origin': u'ISI', 'type': u'references', 'primary': False, 'alternate_journal': False}, 'references': [{'origin': u'ISI', 'bibcode': u'1981A&A....98..251B', 'extension': None, 'content': u'1981A&A....98..251B', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1981ApJ...246..666T', 'extension': None, 'content': u'1981ApJ...246..666T', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1981ApJ...246L.105H', 'extension': None, 'content': u'1981ApJ...246L.105H', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1981MNRAS.196..747H', 'extension': None, 'content': u'1981MNRAS.196..747H', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1982A&A...114..400H', 'extension': None, 'content': u'1982A&A...114..400H', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1982ApJ...252..125T', 'extension': None, 'content': u'1982ApJ...252..125T', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1982ApJ...256..460K', 'extension': None, 'content': u'1982ApJ...256..460K', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1982ApJ...258...64A', 'extension': None, 'content': u'1982ApJ...258...64A', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1983MNRAS.202...37S', 'extension': None, 'content': u'1983MNRAS.202...37S', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1983MNRAS.202.1001B', 'extension': None, 'content': u'1983MNRAS.202.1001B', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1984A&A...141..309B', 'extension': None, 'content': u'1984A&A...141..309B', 'score': u'1', 'arxid': u'', 'doi': u''}, {'origin': u'ISI', 'bibcode': u'1984MNRAS.208..111S', 'extension': None, 'content': u'1984MNRAS.208..111S', 'score': u'1', 'arxid': u'', 'doi': u''}]}
RELATIONS_ENFORCED={'tempdata': {'modtime': None, 'origin': u'ADS metadata', 'type': u'relations', 'primary': False, 'alternate_journal': False}, 'links': [{'access':None, 'origin': None, 'url': u'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K', 'type': u'ned', 'count': u'1', 'title': None}], 'preprints': [], 'alternates': []}

RECORDS=[]

INPUT_DOC = {'bibcode': u'testbibcode', 'text': {'body': {'content': u'Some fulltext hashimoto', 'modtime': '', 'language': '', 'provider': u'some provider'}, 'acknowledgments': {'content': '', 'modtime': '', 'provider': ''}}, 'JSON_fingerprint': u'fake_fingerprint', 'adsdata': {'simbad_objects': [{'type': 'type1', 'id': '5'}, {'type': 'type2', 'id': '3000001'}], 'read_count': u'50', 'citations': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'], 'readers': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'], 'grants': [{'agency': u'NASA', 'grant': u'123456-78'}, {'agency': u'NSF-AST', 'grant': u'0618398'}], 'norm_cites': u'5002', 'boost': u'0.52', 'citation_count': 12}, '_id': 99999999, 'metadata': {'references': [{'origin': '', 'bibcode': u'2014JNuM..455...10R', 'extension': '', 'content': '', 'score': '1', 'doi': ''}, {'origin': '', 'bibcode': u'2014JNuM..455...10T', 'extension': '', 'content': '', 'score': '5', 'doi': ''}], 'properties': {'refereed': False, 'openaccess': True, 'doctype': {'content': u'Catalog', 'origin': ''}, 'private': False, 'ocrabstract': True, 'ads_openaccess':True, 'eprint_openaccess': False, 'pub_openaccess': False, 'databases': [{'content': u'phy', 'origin': ''}, {'content': u'ast', 'origin': ''}], 'bibgroups': [{'content': u'Cfa', 'origin': ''}]}, 'relations': {'preprints': [{'content': u'arxiv:1234.5678', 'origin': '', 'ecode': ''}, {'content': u'ARXIV:hep-ph/1234', 'origin': '', 'ecode': ''}], 'links': [{'origin': None, 'url': 'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=2013A%26A...552A.143S', 'type': 'ned', 'count': '78', 'title': None, 'access': None}, {'origin': None, 'url': 'http://www.aanda.org/10.1051/0004-6361/201321247/postscript', 'type': 'postscript', 'count': None, 'title': None, 'access': 'open'}, {'origin': None, 'url': 'http://dx.doi.org/10.1051%2F0004-6361%2F201321247', 'type': 'electr', 'count': None, 'title': None, 'access': 'open'}, {'origin': None, 'url': 'http://$SIMBAD$/simbo.pl?bibcode=2013A%26A...552A.143S', 'type': 'simbad', 'count': '74', 'title': None, 'access': None}, {'origin': None, 'url': 'http://www.aanda.org/10.1051/0004-6361/201321247/pdf', 'type': 'pdf', 'count': None, 'title': None, 'access': 'open'}]}, 'general': {'doi': [{'content': u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789', 'origin': ''}], 'publication': {'origin': '', 'volume': u'l24', 'dates': [{'content': u'2013-08-05', 'type': u'date-published'}], 'issue': u'24i', 'page': u'2056-2078'}, 'titles': [{'lang': u'en', 'text': u'This is of the title'}, {'lang': '', 'text': u'This is of the alternate'}], 'authors': [{'name': {'normalized': u'T Hooft, V', 'western': u"t'Hooft, van X", 'native': ''}, 'number': u'1', 'affiliations': [], 'orcid': '', 'type': '', 'emails': []}, {'name': {'normalized': u'Anders, J M', 'western': u'Anders, John Michael', 'native': ''}, 'number': u'2', 'affiliations': [u'NASA Kavli space center, Cambridge, MA 02138, USA'], 'orcid': '', 'type': '', 'emails': [u'anders@email.com']}, {'name': {'normalized': u'Einstein, A', 'western': u'Einstein, A', 'native': ''}, 'number': u'3', 'affiliations': [u'Einsteininstitute, Zurych, Switzerland'], 'orcid': '', 'type': '', 'emails': []}], 'keywords': [{'origin': '', 'type': u'PACS Codes', 'normalized': u'stat mech', 'channel': '', 'original': u'Classical Statistical mechanics'}], 'abstracts': [{'lang': '', 'origin': u'some origin', 'text': u"all no-skysurvey q'i quotient"}]}}}

EXPECTED_SOLR_DOC={'author': [u"t'Hooft, van X", u'Anders, John Michael', u'Einstein, A'], 'keyword_norm': [u'stat mech'], 'bibgroup': [u'Cfa'], 'pubdate': u'2013-08-05', 'title': [u'This is of the title', u'This is of the alternate'], 'keyword_schema': [u'PACS Codes'], 'bibgroup_facet': [u'Cfa'], 'bibstem_facet': u'bibcode', 'volume': u'l24', 'doi': [u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789'], 'author_norm': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'], 'alternate_title': [u'This is of the alternate'], 'first_author_norm': u'T Hooft, V', 'keyword': [u'Classical Statistical mechanics'], 'grant_facet_hier': [u'0/NASA', u'1/NASA/123456-78', u'0/NSF-AST', u'1/NSF-AST/0618398'], 'citation_count': 2, 'cite_read_boost': 0.52, 'property': [u'OPENACCESS', u'OCRABSTRACT',u'ADS_OPENACCESS', u'NONARTICLE',u'NOT REFEREED'], 'page': [u'2056-2078'], 'keyword_facet': [u'stat mech'], 'read_count': 2, 'reference': [u'2014JNuM..455...10R',], 'first_author': u"t'Hooft, van X", 'abstract': u"all no-skysurvey q'i quotient", 'citation': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'], 'links_data': [u'{"title":"", "type":"ned", "instances":"78", "access":""}', u'{"title":"", "type":"postscript", "instances":"", "access":"open"}', u'{"title":"", "type":"electr", "instances":"", "access":"open"}', u'{"title":"", "type":"simbad", "instances":"74", "access":""}', u'{"title":"", "type":"pdf", "instances":"", "access":"open"}'], 'id': 99999999, 'simbid': [5, 3000001], 'simbtype': [u'Other'], 'simbad_object_facet_hier': [u'0/Other', u'1/Other/5', u'0/Other', u'1/Other/3000001'],'bibcode': u'testbibcode', 'author_facet_hier': [u'0/T Hooft, V', u"1/T Hooft, V/t'Hooft, van X", u'0/Anders, J M', u'1/Anders, J M/Anders, John Michael', u'0/Einstein, A', u'1/Einstein, A/Einstein, A'], 'grant': [u'NASA', u'123456-78', u'NSF-AST', u'0618398'], 'aff': [u'-', u'NASA Kavli space center, Cambridge, MA 02138, USA', u'Einsteininstitute, Zurych, Switzerland'], 'reader': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'], 'issue': u'24i', 'email': [u'-', u'anders@email.com', u'-'], 'orcid_pub': [u'-', u'-', u'-'], 'body': u'Some fulltext hashimoto', 'date': u'2013-08-05T00:30:00.000000Z', 'classic_factor': 5002, 'identifier': [u'arxiv:1234.5678', u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789', u'ARXIV:hep-ph/1234'], 'database': [u'astronomy', u'physics'], 'bibstem': [u'bibco', u'bibcode'], 'first_author_facet_hier': [u'0/T Hooft, V', u"1/T Hooft, V/t'Hooft, van X"], 'author_facet': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'], u'doctype': u'catalog'}


INPUT_DOC1={
    "_id" : 99999998,
    "modtime" : "2014-11-06T14:11:18.697474Z",
    "bibcode" : u"2000A&AS..143...41K_test",
    "JSON_fingerprint" : "{\"abs\":[{\"p\":\"/proj/ads/abstracts/ast/text/J20/J20-02694.abs\",\"primary\":1,\"t\":\"1317932566\"},{\"p\":\"/proj/ads/abstracts/ast/text/S20/S20-02694.abs\",\"t\":\"1347312274\"}],\"full\":[{\"p\":\"/proj/ads/fulltext/extracted/20/00/A&/AS/,,/14/3,/,,/41/K//meta.json\",\"t\":1395500064},{\"p\":\"/proj/ads/fulltext/extracted/20/00/A&/AS/,,/14/3,/,,/41/K//fulltext.txt\",\"t\":1363680233}],\"links\":{\"electr\":[{\"u\":\"http://dx.doi.org/10.1051%2Faas%3A2000170\"}],\"preprint\":[{\"u\":\"astro-ph/0002104\"}],\"spires\":[{\"u\":\"http://inspirehep.net/search?p=find+j+AAESB,143,41\"}]},\"prop\":[\"bibgroup: CfA\",\"refereed\"],\"refs\":[{\"p\":\"/proj/ads/references/resolved/A+AS/0143/iss1.raw.result\",\"t\":1374540245},{\"p\":\"/proj/ads/references/resolved/AUTHOR/Markus/MarkusMagic.pairs.result\",\"t\":1412026020},{\"p\":\"/proj/ads/references/resolved/ISI/A&AS/A&AS0143.isi.pairs.result\",\"t\":1414726893}]};{\"abs\":[{\"p\":\"/proj/ads/abstracts/pre/text/X00/X00-03262.abs\",\"primary\":1,\"t\":\"1257155059\"}],\"links\":{\"electr\":[{\"u\":\"http://dx.doi.org/10.1051%2Faas%3A2000170\"}],\"preprint\":[{\"u\":\"astro-ph/0002104\"}],\"spires\":[{\"u\":\"http://inspirehep.net/search?p=find+eprint+astro-ph/0002104\"}]},\"prop\":[\"bibgroup: CfA\"],\"refs\":[{\"p\":\"/proj/ads/references/resolved/astro-ph/2000/0002104.raw.result\",\"t\":1360840132}]}",

    "text": {},
    "metadata" : {
    "references": [],
    'properties': {'refereed': True, 'openaccess': False, 
                   'doctype': {'content': u'article', 'origin': u'ADS metadata'}, 
                   'private': False, 'ocrabstract': False, 
                   'ads_openaccess': False,
                   'eprint_openaccess': False,
                   'pub_openaccess': False,
                   'databases': [{'content': u'ast', 'origin': ''}], 
                   'bibgroups': [{'content': u'CfA', 'origin': ''}],
                   'data_sources': [{'content':u'foo','origin':u'bar'},{'content':u'foo2'}],
                   'vizier_tables': [{'content':u'tab1','origin':u'vizier'},{'content':u'tab2'}],
                   },
    "relations": {},
    "general" : {
        "comment" : [ ],
        "doi" : [
            {
                "origin" : u"A&AS",
                "content" : u"10.1051/aas:2000170"
                }
            ],
        "titles" : [
                {
                "lang" : u"en",
                "text" : u"The NASA Astrophysics Data System: Overview"
                }
            ],
        "publication" : {
            "origin" : u"A&AS",
            "dates" : [
                {
                    "content" : u"2000-04-00",
                    "type" : u"date-published"
                    },
                {
                    "content" : u"2000",
                    "type" : u"publication_year"
                    }
                ],
            "name" : {
                "raw" : u"Astronomy and Astrophysics Supplement, v.143, p.41-59",
                "canonical" : u"Astronomy and Astrophysics Supplement Series"
                },
            "page_count" : u"19",
            "page" : u"41",
            "volume" : u"143",
            "page_range" : u"41-59",
            "electronic_id" : u"here is the eid",
            "issue" : None,
            "page_last" : u"59"
            },
        "language" : u"",
        "issns" : [ ],
        "conf_metadata" : {
            "origin" : u"A&AS",
            "content" : None
            },
        "copyright" : [ ],
        "isbns" : [ ],
        "authors" : [
            {
                "name" : {
                    "native" : None,
                    "western" : u"Kurtz, Michael J.",
                    "normalized" : u"Kurtz, M"
                    },
                "number" : u"1",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Eichhorn, Guenther",
                    "normalized" : u"Eichhorn, G"
                    },
                "number" : u"2",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Accomazzi, Alberto",
                    "normalized" : u"Accomazzi, A"
                    },
                "number" : u"3",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : u"0000-0002-4110-3511",
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Grant, Carolyn S.",
                    "normalized" : u"Grant, C"
                    },
                "number" : u"4",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Murray, Stephen S.",
                    "normalized" : u"Murray, S"
                    },
                "number" : u"5",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Watson, Joyce M.",
                    "normalized" : u"Watson, J"
                    },
                "number" : u"6",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                }
            ],
        "keywords" : [
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"METHODS: DATA ANALYSIS",
                "channel" : u"",
                "normalized" : u"methods data analysis"
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"ASTRONOMICAL DATABASES: MISCELLANEOUS",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"PUBLICATIONS: BIBLIOGRAPHY",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"SOCIOLOGY OF ASTRONOMY",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"ARXIV",
                "type" : u"arXiv",
                "original" : u"Astrophysics",
                "channel" : u"astro-ph",
                "normalized" : u"astrophysics"
                }
            ],
        "arxivcategories" : [
            u"Astrophysics"
            ],
        "pubnote" : [
            {
                "origin" : u"ARXIV",
                "content" : {
                    "@origin" : u"ARXIV",
                    "#text" : u"19 pages, 22 figures; Astron.Astrophys.Suppl.Ser. 143 (2000) 41-59; doi:10.1051/aas:2000170"
                    }
                }
            ],
        "altpublications" : [
            {
                "origin" : u"ARXIV",
                "dates" : [
                    {
                        "content" : u"2000-02-00",
                        "type" : u"date-preprint"
                        },
                    {
                        "content" : u"2000",
                        "type" : u"publication_year"
                        }
                    ],
                "name" : {
                    "raw" : u"eprint arXiv:astro-ph/0002104",
                    "canonical" : u"ArXiv e-prints"
                    },
                "page_count" : None,
                "page" : None,
                "volume" : None,
                "page_range" : None,
                "electronic_id" : u"astro-ph/0002104",
                "altbibcode" : u"2000astro.ph..2104K",
                "issue" : None,
                "page_last" : None
                }
            ],
        }
    }
}

EXPECTED_SOLR_DOC1={
    "first_author": u"Kurtz, Michael J.", 
#    "links_data": [u"{\"title\":\"\",\"type\":\"spires\",\"instances\":\"\"}", "{\"title\":\"\",\"type\":\"electr\",\"instances\":\"\"}", "{\"title\":\"\",\"type\":\"spires\",\"instances\":\"\"}"], 
    "first_author_norm": u"Kurtz, M", 
    "year": u"2000", 
    "id":99999998, 
    "bibcode": u"2000A&AS..143...41K_test", 
    "author_facet_hier": [
        u"0/Kurtz, M", u"1/Kurtz, M/Kurtz, Michael J.",
        u"0/Eichhorn, G", u"1/Eichhorn, G/Eichhorn, Guenther", 
        u"0/Accomazzi, A", u"1/Accomazzi, A/Accomazzi, Alberto", 
        u"0/Grant, C", u"1/Grant, C/Grant, Carolyn S.", 
        u"0/Murray, S", u"1/Murray, S/Murray, Stephen S.",
        u"0/Watson, J", u"1/Watson, J/Watson, Joyce M."], 
    "bibstem": [u"A&AS", u"A&AS..143"], 
    "aff": [
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA",
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"], 
    "keyword": [u"METHODS: DATA ANALYSIS", 
                u"ASTRONOMICAL DATABASES: MISCELLANEOUS", 
                u"PUBLICATIONS: BIBLIOGRAPHY", 
                u"SOCIOLOGY OF ASTRONOMY", 
                u"Astrophysics"], 
    "keyword_norm": [u"methods data analysis", u"-", u"-", u"-",
                     u"astrophysics"], 
    "keyword_schema": [u"Astronomy", u"Astronomy",
                       u"Astronomy", u"Astronomy", u"arXiv"], 
    "keyword_facet": [u"methods data analysis",
                      u"astrophysics"], 
    "email": [u"-", u"-", u"-", u"-", u"-", u"-"],
    "orcid_pub": [u"-", u"-", u"0000-0002-4110-3511", u"-", u"-", u"-"],
    'data': [u'foo',u'foo2'],
    'data_facet': [u'foo',u'foo2'],
    "arxiv_class": [u"Astrophysics"], 
    "bibgroup": [u"CfA"],
    "bibgroup_facet": [u"CfA"],
    "author_facet": [u"Kurtz, M", u"Eichhorn, G",
                     u"Accomazzi, A", u"Grant, C", u"Murray, S", u"Watson, J"],
    "bibstem_facet": u"A&AS", 
    "pub": u"Astronomy and Astrophysics Supplement Series", 
    "volume": u"143", 
    "doi": [u"10.1051/aas:2000170"],
    "eid": u"here is the eid",
    "author_norm": [u"Kurtz, M", u"Eichhorn, G", u"Accomazzi, A", u"Grant, C",
                    u"Murray, S", u"Watson, J"], 
    "date": u"2000-04-01T00:00:00.000000Z",
    "pubdate": u"2000-04-00", 
    "identifier": [u"10.1051/aas:2000170"],
    "database": [u"astronomy"], 
    "author":
        [u"Kurtz, Michael J.", u"Eichhorn, Guenther", u"Accomazzi, Alberto",
         u"Grant, Carolyn S.", u"Murray, Stephen S.", u"Watson, Joyce M."],
    "citation_count": 0, 
    "pub_raw": u"Astronomy and Astrophysics Supplement, v.143, p.41-59", 
#    "cite_read_boost": 0.45,
    "first_author_facet_hier": [u"0/Kurtz, M", u"1/Kurtz, M/Kurtz, Michael J."], 
    "title": [u"The NASA Astrophysics Data System: Overview"],
    "property": [u"REFEREED", u"ARTICLE"], 
    "page": [u"41",u"here is the eid"],
    'vizier':[u'tab1',u'tab2'],
    'vizier_facet':[u'tab1',u'tab2'],
    "read_count": 0,
    'doctype': u'article',
}

INPUT_DOC2={
    "_id" : 99999997,
    "modtime" : '2014-06-18T21:06:49',
    'bibcode' : u'2014arXiv1406.4542H',
    "text": {},
    "metadata" : {
        "references": [],
        'properties': {'refereed': False, 'openaccess': True, 
                       'doctype': {'content': u'article', 'origin': u'ADS metadata'}, 
                       'private': False, 'ocrabstract': False, 'ads_openaccess':False,
                       'eprint_openaccess': True, 'pub_openaccess': False
                   },
        "relations": {},
        "general" : {
            "publication" : {
                "origin" : u"ARXIV",
                'dates' : [
                    {
                        'type' : u'date-preprint',
                        'content' : u'2014-06-00'
                        }
                    ]
                },
            'authors': [
                {'name': {'normalized': u'T Hooft, V', 'western': u"t'Hooft, van X", 'native': ''}, 
                 'number': u'1', 'affiliations': [], 'orcid': '', 'type': '', 'emails': []}, 
                {'name': {'normalized': u'Anders, J M', 'western': u'Anders, John Michael', 'native': ''}, 
                 'number': u'2', 'affiliations': [u'NASA Kavli space center, Cambridge, MA 02138, USA'], 
                 'orcid': '', 'type': '', 'emails': [u'anders@email.com']}, 
                {'name': {'normalized': u'Einstein, A', 'western': u'Einstein, A', 'native': ''}, 
                 'number': u'3', 'affiliations': [u'Einsteininstitute, Zurych, Switzerland'], 
                 'orcid': '', 'type': '', 'emails': []}],
            }
        },
    'orcid_claims': {'verified': [u'-', u'1111-2222-3333-4444', u'-']}
    }


EXPECTED_SOLR_DOC2={
    "id" : 99999997, 
    'bibcode' : u'2014arXiv1406.4542H',
    'date':     u'2014-06-01T00:00:00.000000Z',
    'bibstem': [u'arXiv', u'arXiv1406'],
    'bibstem_facet': u'arXiv',
    'pubdate' : u'2014-06-00',
    "property": [u"OPENACCESS", u"EPRINT_OPENACCESS", u"ARTICLE", u"NOT REFEREED"], 
    "read_count": 0,
    "citation_count": 0,
    'doctype': u'article',
    
    'aff': [u'-',
          u'NASA Kavli space center, Cambridge, MA 02138, USA',
          u'Einsteininstitute, Zurych, Switzerland'],
   'author': [u"t'Hooft, van X", u'Anders, John Michael', u'Einstein, A'],
   'author_facet': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
   'author_facet_hier': [u'0/T Hooft, V',
                         u"1/T Hooft, V/t'Hooft, van X",
                         u'0/Anders, J M',
                         u'1/Anders, J M/Anders, John Michael',
                         u'0/Einstein, A',
                         u'1/Einstein, A/Einstein, A'],
   'author_norm': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
    'email': [u'-', u'anders@email.com', u'-'],
    'first_author': u"t'Hooft, van X",
    'first_author_facet_hier': [u'0/T Hooft, V', u"1/T Hooft, V/t'Hooft, van X"],
    'first_author_norm': u'T Hooft, V',
    'orcid_pub': [u'-', u'-', u'-'],
    'orcid_user': [u'-', u'1111-2222-3333-4444', u'-']
}

