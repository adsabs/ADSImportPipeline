# -*- coding: utf-8 -*-
from collections import OrderedDict
import os

# TODO(rca): remove the unnecessary tests; it is bloody confusing what is what in here

GENERAL = OrderedDict([(u'@origin', u'AAS'),
             (u'@type', u'general'),
             (u'@primary', u'True'),
             (u'@alternate_journal', u'False'),
             (u'creation_time', u'2012-08-06T19:12:47'),
             (u'modification_time', u'2012-08-06T19:12:47'),
             (u'bibcode', u'2010AAS...21542816H'),
             (u'dates',
              OrderedDict([(u'date',
                            OrderedDict([(u'@type', u'date-published'),
                                         ('#text', u'2010-01-00')]))])),
             (u'title',
              u'Characteristics Of Hydrocarbon Emission From Herbig Ae/be Stars'),
             (u'abstract',
              u'We present analysis of polycyclic aromatic hydrocarbon (PAH) emission in mid-infrared spectra of a large sample of Herbig Ae and Be (HAeBe) stars. The spectra were obtained with the Infrared Spectrograph on the Spitzer Space Telescope. In a previous study of 18 HAeBe stars we found: evidence that the PAH ionization fraction in the circumstellar material around HAeBe stars is related to the structure of the PAH molecules; that the center wavelengths of the PAH emission features change systematically with stellar effective temperature changes; and that HAeBe stars have may have unique mid-infrared spectral characteristics that distinguish them from other strong PAH emission sources. We also found no simple correlation between the integrated intensity of PAH emission from HAeBe stars and the geometry of their proto-planetary disks. We now have expanded the sample to include 50 stars using archival data from the Spitzer database. We present a similar analysis applied to the larger sample.'),
             (u'author',
              [OrderedDict([(u'@nr', u'1'),
                            (u'name',
                             OrderedDict([(u'western', u'Hyatt, Jordan'),
                                          (u'normalized', u'Hyatt, J')])),
                            (u'affiliations',
                             OrderedDict([(u'affiliation',
                                           u'Ithaca College')])),
                            (u'type', u'regular')]),
               OrderedDict([(u'@nr', u'2'),
                            (u'name',
                             OrderedDict([(u'western', u'Keller, L. D.'),
                                          (u'normalized', u'Keller, L')])),
                            (u'affiliations',
                             OrderedDict([(u'affiliation',
                                           u'Ithaca College')])),
                            (u'type', u'regular')]),
               OrderedDict([(u'@nr', u'3'),
                            (u'name',
                             OrderedDict([(u'western', u'Sloan, G. C.'),
                                          (u'normalized', u'Sloan, G')])),
                            (u'affiliations',
                             OrderedDict([(u'affiliation',
                                           u'Cornell University')])),
                            (u'type', u'regular')]),
               OrderedDict([(u'@nr', u'4'),
                            (u'name',
                             OrderedDict([(u'western', u'Geidel, K. L.'),
                                          (u'normalized', u'Geidel, K')])),
                            (u'affiliations',
                             OrderedDict([(u'affiliation',
                                           u'Ithaca College')])),
                            (u'type', u'regular')])]),
             (u'ADSaffiliation',
              u'AA(Ithaca College), AB(Ithaca College), AC(Cornell University), AD(Ithaca College)'),
             (u'journal',
              u'American Astronomical Society, AAS Meeting #215, #428.16; <ALTJOURNAL>Bulletin of the American Astronomical Society, Vol. 42, p.347</ALTJOURNAL>'),
             (u'canonical_journal',
              u'American Astronomical Society Meeting Abstracts #215'),
             (u'electronic_id', u'428.16'),
             (u'publication_year', u'2010'),
             (u'volume', u'215')])

PROPERTIES = OrderedDict([(u'@origin', u'ADS metadata'),
             (u'vizier_tables',
              OrderedDict([(u'vizier_table',
                            [u'Galaxies', u'HII regions', u'Optical'])])),
             (u'@type', u'properties'),
             (u'@primary', u'False'),
             (u'@alternate_journal', u'False'),
             (u'JSON_timestamp',
              u'{"abs":[{"p":"/proj/ads/abstracts/ast/text/A85/A85-29431.abs","primary":1,"t":"1386214979"},{"p":"/proj/ads/abstracts/ast/text/J85/J85-29431.abs","t":"1321421644"},{"p":"/proj/ads/abstracts/ast/text/S85/S85-29431.abs","t":"1347305751"}],"full":[{"p":"/proj/ads/fulltext/extracted/19/85/A&/A,/,,/14/2,/,,/,1/K//meta.json","t":1395490755},{"p":"/proj/ads/fulltext/extracted/19/85/A&/A,/,,/14/2,/,,/,1/K//fulltext.txt","t":1363068221}],"links":{"associated":[{"t":"Part  1","u":"1983IAUS..100...99V"},{"t":"Part  2","u":"1984A&A...133..127K"},{"t":"Part  3","u":"1985A&A...142....1K"},{"t":"Part  4","u":"1985A&A...144..202K"},{"t":"Part  5","u":"1988A&A...191..201V"},{"t":"Part  6","u":"1988A&A...199...41V"},{"t":"Part  7","u":"1988A&A...204...39V"},{"t":"Part  8","u":"1989A&A...218...49V"},{"t":"Part  9","u":"1989A&A...225..317V"},{"t":"Part 11","u":"1991A&A...243...71V"},{"t":"Part 10","u":"1993A&A...269...15V"}],"ned":[{"c":"1","u":"http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K"}]},"prop":["article","refereed"],"refs":[{"p":"/proj/ads/references/resolved/A&A/0142/1985A&A...142....1K.ref.ocr.txt.result","t":1374509778},{"p":"/proj/ads/references/resolved/ISI/A&A/A&A0142.isi.pairs.result","t":1302279738}]}'),
             (u'databases', OrderedDict([(u'database', u'AST')])),
             (u'data_sources', OrderedDict([(u'data_source', u'NED')])),
             (u'pubtype', u'article'),
             (u'refereed', u'1'),
             (u'openaccess', u'1'),
             (u'pub_openaccess', u'0'),
             (u'private', u'0'),
             (u'ocrabstract', u'0'),
             (u'ads_openaccess', u'1'),
             (u'eprint_openaccess', u'0'),
             (u'preprint', None),
             (u'nonarticle', u'0'),
             (u'associates',
              OrderedDict([(u'associate',
                            [OrderedDict([(u'@comment', u'Part  1'),
                                          ('#text', u'1983IAUS..100...99V')]),
                             OrderedDict([(u'@comment', u'Part  2'),
                                          ('#text', u'1984A&A...133..127K')]),
                             OrderedDict([(u'@comment', u'Part  3'),
                                          ('#text', u'1985A&A...142....1K')]),
                             OrderedDict([(u'@comment', u'Part  4'),
                                          ('#text', u'1985A&A...144..202K')]),
                             OrderedDict([(u'@comment', u'Part  5'),
                                          ('#text', u'1988A&A...191..201V')]),
                             OrderedDict([(u'@comment', u'Part  6'),
                                          ('#text', u'1988A&A...199...41V')]),
                             OrderedDict([(u'@comment', u'Part  7'),
                                          ('#text', u'1988A&A...204...39V')]),
                             OrderedDict([(u'@comment', u'Part  8'),
                                          ('#text', u'1989A&A...218...49V')]),
                             OrderedDict([(u'@comment', u'Part  9'),
                                          ('#text', u'1989A&A...225..317V')]),
                             OrderedDict([(u'@comment', u'Part 11'),
                                          ('#text', u'1991A&A...243...71V')]),
                             OrderedDict([(u'@comment', u'Part 10'),
                                          ('#text',
                                           u'1993A&A...269...15V')])])]))])
REFERENCES = OrderedDict([(u'@origin', u'ISI'),
             (u'@source', u'A&A0142.isi.pairs'),
             (u'@type', u'references'),
             (u'@primary', u'False'),
             (u'@alternate_journal', u'False'),
             (u'creation_time', u'2011-04-08T16:22:18'),
             (u'modification_time', u'2011-04-08T16:22:18'),
             (u'reference',
              [OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1981A&A....98..251B'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1981A&A....98..251B')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1981ApJ...246..666T'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1981ApJ...246..666T')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1981ApJ...246L.105H'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1981ApJ...246L.105H')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1981MNRAS.196..747H'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1981MNRAS.196..747H')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1982A&A...114..400H'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1982A&A...114..400H')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1982ApJ...252..125T'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1982ApJ...252..125T')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1982ApJ...256..460K'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1982ApJ...256..460K')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1982ApJ...258...64A'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1982ApJ...258...64A')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1983MNRAS.202...37S'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1983MNRAS.202...37S')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1983MNRAS.202.1001B'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1983MNRAS.202.1001B')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1984A&A...141..309B'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1984A&A...141..309B')]),
               OrderedDict([(u'@origin', u'ISI'),
                            (u'@bibcode', u'1984MNRAS.208..111S'),
                            (u'@score', u'1'),
                            (u'@arxid', u''),
                            (u'@doi', u''),
                            ('#text', u'1984MNRAS.208..111S')])])]) 
RELATIONS = OrderedDict([(u'@origin', u'ADS metadata'),
             (u'@type', u'relations'),
             (u'@primary', u'False'),
             (u'@alternate_journal', u'False'),
             (u'alternates', None),
             (u'links',
              OrderedDict([(u'link',
                            [OrderedDict([(u'@url',
                                           u'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K'),
                                          (u'@count', u'1'),
                                          (u'@type', u'ned')]),
                             OrderedDict([(u'@url',
                                           u'http://adsabs.harvard.edu/abs/1985A%26A...142....1K'),
                                          (u'@type', u'ADSlink')])])]))])
 
GENERAL_ENFORCED = {'abstracts': [{'lang': u'en',
   'origin': u'AAS',
   'text': u'We present analysis of polycyclic aromatic hydrocarbon (PAH) emission in mid-infrared spectra of a large sample of Herbig Ae and Be (HAeBe) stars. The spectra were obtained with the Infrared Spectrograph on the Spitzer Space Telescope. In a previous study of 18 HAeBe stars we found: evidence that the PAH ionization fraction in the circumstellar material around HAeBe stars is related to the structure of the PAH molecules; that the center wavelengths of the PAH emission features change systematically with stellar effective temperature changes; and that HAeBe stars have may have unique mid-infrared spectral characteristics that distinguish them from other strong PAH emission sources. We also found no simple correlation between the integrated intensity of PAH emission from HAeBe stars and the geometry of their proto-planetary disks. We now have expanded the sample to include 50 stars using archival data from the Spitzer database. We present a similar analysis applied to the larger sample.'}],
 'arxivcategories': [],
 'authors': [{'affiliations': [u'Ithaca College'],
   'emails': [],
   'name': {'native': None,
    'normalized': u'Hyatt, J',
    'western': u'Hyatt, Jordan'},
   'number': u'1',
   'orcid': None,
   'type': u'regular'},
  {'affiliations': [u'Ithaca College'],
   'emails': [],
   'name': {'native': None,
    'normalized': u'Keller, L',
    'western': u'Keller, L. D.'},
   'number': u'2',
   'orcid': None,
   'type': u'regular'},
  {'affiliations': [u'Cornell University'],
   'emails': [],
   'name': {'native': None,
    'normalized': u'Sloan, G',
    'western': u'Sloan, G. C.'},
   'number': u'3',
   'orcid': None,
   'type': u'regular'},
  {'affiliations': [u'Ithaca College'],
   'emails': [],
   'name': {'native': None,
    'normalized': u'Geidel, K',
    'western': u'Geidel, K. L.'},
   'number': u'4',
   'orcid': None,
   'type': u'regular'}],
 'comment': [],
 'conf_metadata': {'content': None, 'origin': u'AAS'},
 'copyright': [],
 'doi': [],
 'isbns': [],
 'issns': [],
 'keywords': [],
 'language': '',
 'publication': {'altbibcode': u'2010AAS...21542816H',
  'dates': [{'content': u'2010-01-00', 'type': u'date-published'},
   {'content': u'2010', 'type': 'publication_year'}],
  'electronic_id': u'428.16',
  'issue': None,
  'name': {'canonical': u'American Astronomical Society Meeting Abstracts #215',
   'raw': u'American Astronomical Society, AAS Meeting #215, #428.16; <ALTJOURNAL>Bulletin of the American Astronomical Society, Vol. 42, p.347</ALTJOURNAL>'},
  'origin': u'AAS',
  'page': None,
  'page_count': None,
  'page_last': None,
  'page_range': None,
  'volume': u'215'},
 'pubnote': [],
 'tempdata': {'alternate_journal': False,
  'modtime': u'2012-08-06T19:12:47',
  'origin': u'AAS',
  'primary': True,
  'type': u'general'},
 'titles': [{'lang': u'en',
   'text': u'Characteristics Of Hydrocarbon Emission From Herbig Ae/be Stars'}]}

PROPERTIES_ENFORCED = {'ads_openaccess': True,
 'associates': [{'comment': u'Part  1',
   'content': u'1983IAUS..100...99V',
   'origin': u'ADS metadata'},
  {'comment': u'Part  2',
   'content': u'1984A&A...133..127K',
   'origin': u'ADS metadata'},
  {'comment': u'Part  3',
   'content': u'1985A&A...142....1K',
   'origin': u'ADS metadata'},
  {'comment': u'Part  4',
   'content': u'1985A&A...144..202K',
   'origin': u'ADS metadata'},
  {'comment': u'Part  5',
   'content': u'1988A&A...191..201V',
   'origin': u'ADS metadata'},
  {'comment': u'Part  6',
   'content': u'1988A&A...199...41V',
   'origin': u'ADS metadata'},
  {'comment': u'Part  7',
   'content': u'1988A&A...204...39V',
   'origin': u'ADS metadata'},
  {'comment': u'Part  8',
   'content': u'1989A&A...218...49V',
   'origin': u'ADS metadata'},
  {'comment': u'Part  9',
   'content': u'1989A&A...225..317V',
   'origin': u'ADS metadata'},
  {'comment': u'Part 11',
   'content': u'1991A&A...243...71V',
   'origin': u'ADS metadata'},
  {'comment': u'Part 10',
   'content': u'1993A&A...269...15V',
   'origin': u'ADS metadata'}],
 'bibgroups': [],
 'data_sources': [{'content': u'NED', 'origin': u'ADS metadata'}],
 'databases': [{'content': u'AST', 'origin': u'ADS metadata'}],
 'doctype': {'content': u'article', 'origin': u'ADS metadata'},
 'eprint_openaccess': False,
 'ocrabstract': False,
 'openaccess': True,
 'private': False,
 'pub_openaccess': False,
 'refereed': True,
 'tempdata': {'alternate_journal': False,
  'modtime': None,
  'origin': u'ADS metadata',
  'primary': False,
  'type': u'properties'},
 'vizier_tables': [{'content': u'Galaxies', 'origin': u'ADS metadata'},
  {'content': u'HII regions', 'origin': u'ADS metadata'},
  {'content': u'Optical', 'origin': u'ADS metadata'}]}

REFERENCES_ENFORCED = {'references': [{'arxid': u'',
   'bibcode': u'1981A&A....98..251B',
   'content': u'1981A&A....98..251B',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1981ApJ...246..666T',
   'content': u'1981ApJ...246..666T',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1981ApJ...246L.105H',
   'content': u'1981ApJ...246L.105H',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1981MNRAS.196..747H',
   'content': u'1981MNRAS.196..747H',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1982A&A...114..400H',
   'content': u'1982A&A...114..400H',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1982ApJ...252..125T',
   'content': u'1982ApJ...252..125T',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1982ApJ...256..460K',
   'content': u'1982ApJ...256..460K',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1982ApJ...258...64A',
   'content': u'1982ApJ...258...64A',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1983MNRAS.202...37S',
   'content': u'1983MNRAS.202...37S',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1983MNRAS.202.1001B',
   'content': u'1983MNRAS.202.1001B',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1984A&A...141..309B',
   'content': u'1984A&A...141..309B',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'},
  {'arxid': u'',
   'bibcode': u'1984MNRAS.208..111S',
   'content': u'1984MNRAS.208..111S',
   'doi': u'',
   'extension': None,
   'origin': u'ISI',
   'score': u'1'}],
 'tempdata': {'alternate_journal': False,
  'modtime': u'2011-04-08T16:22:18',
  'origin': u'ISI',
  'primary': False,
  'type': u'references'}}



RELATIONS_ENFORCED = {'alternates': [],
 'links': [{'access': None,
   'count': u'1',
   'origin': None,
   'title': None,
   'type': u'ned',
   'url': u'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=1985A%26A...142....1K'}],
 'preprints': [],
 'tempdata': {'alternate_journal': False,
  'modtime': None,
  'origin': u'ADS metadata',
  'primary': False,
  'type': u'relations'}}

RECORDS=[]

INPUT_DOC = {'JSON_fingerprint': u'fake_fingerprint',
 'adsdata': {'boost': u'0.52',
  'citation_count': 12,
  'citations': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'],
  'grants': [{'agency': u'NASA', 'grant': u'123456-78'},
   {'agency': u'NSF-AST', 'grant': u'0618398'}],
  'norm_cites': u'5002',
  'read_count': u'50',
  'readers': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'],
  'simbad_objects': [{'id': '5', 'type': 'type1'},
   {'id': '3000001', 'type': 'type2'}],
  'ned_objects': [{'id': 'foo bar', 'type': 'type1'},
   {'id': 'X+1-5 =6', 'type': 'type2'}]},
 'bibcode': u'testbibcode',
 'id': 99999999,
 'metadata': {'general': {'abstracts': [{'lang': '',
     'origin': u'some origin',
     'text': u"all no-skysurvey q'i quotient"}],
   'authors': [{'affiliations': [],
     'emails': [],
     'name': {'native': '',
      'normalized': u'T Hooft, V',
      'western': u"t'Hooft, van X"},
     'number': u'1',
     'orcid': '',
     'type': ''},
    {'affiliations': [u'NASA Kavli space center, Cambridge, MA 02138, USA'],
     'emails': [u'anders@email.com'],
     'name': {'native': '',
      'normalized': u'Anders, J M',
      'western': u'Anders, John Michael'},
     'number': u'2',
     'orcid': '',
     'type': ''},
    {'affiliations': [u'Einsteininstitute, Zurych, Switzerland'],
     'emails': [],
     'name': {'native': '',
      'normalized': u'Einstein, A',
      'western': u'Einstein, A'},
     'number': u'3',
     'orcid': '',
     'type': ''}],
   'doi': [{'content': u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789',
     'origin': ''}],
   'keywords': [{'channel': '',
     'normalized': u'stat mech',
     'origin': '',
     'original': u'Classical Statistical mechanics',
     'type': u'PACS Codes'}],
   'publication': {'dates': [{'content': u'2013-08-05',
      'type': u'date-published'}],
    'issue': u'24i',
    'origin': '',
    'page': u'2056-2078',
    'volume': u'l24'},
   'titles': [{'lang': u'en', 'text': u'This is of the title'},
    {'lang': '', 'text': u'This is of the alternate'}]},
  'properties': {'ads_openaccess': True,
   'bibgroups': [{'content': u'Cfa', 'origin': ''}],
   'databases': [{'content': u'phy', 'origin': ''},
    {'content': u'ast', 'origin': ''}],
   'doctype': {'content': u'Catalog', 'origin': ''},
   'eprint_openaccess': False,
   'ocrabstract': True,
   'openaccess': True,
   'private': False,
   'pub_openaccess': False,
   'refereed': False},
  'references': [{'bibcode': u'2014JNuM..455...10R',
    'content': '',
    'doi': '',
    'extension': '',
    'origin': '',
    'score': '1'},
   {'bibcode': u'2014JNuM..455...10T',
    'content': '',
    'doi': '',
    'extension': '',
    'origin': '',
    'score': '5'}],
  'relations': {'links': [{'access': None,
     'count': '78',
     'origin': None,
     'title': None,
     'type': 'ned',
     'url': 'http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=2013A%26A...552A.143S'},
    {'access': 'open',
     'count': None,
     'origin': None,
     'title': None,
     'type': 'postscript',
     'url': 'http://www.aanda.org/10.1051/0004-6361/201321247/postscript'},
    {'access': 'open',
     'count': None,
     'origin': None,
     'title': None,
     'type': 'electr',
     'url': 'http://dx.doi.org/10.1051%2F0004-6361%2F201321247'},
    {'access': None,
     'count': '74',
     'origin': None,
     'title': None,
     'type': 'simbad',
     'url': 'http://$SIMBAD$/simbo.pl?bibcode=2013A%26A...552A.143S'},
    {'access': 'open',
     'count': None,
     'origin': None,
     'title': None,
     'type': 'pdf',
     'url': 'http://www.aanda.org/10.1051/0004-6361/201321247/pdf'}],
   'preprints': [{'content': u'arxiv:1234.5678', 'ecode': '', 'origin': ''},
    {'content': u'ARXIV:hep-ph/1234', 'ecode': '', 'origin': ''}]}},
 'text': {'acknowledgment': {'content': '', 'modtime': '', 'provider': ''},
  'body': {'content': u'Some fulltext hashimoto',
   'language': '',
   'modtime': '',
   'provider': u'some provider'}}} 


EXPECTED_SOLR_DOC = {'abstract': u"all no-skysurvey q'i quotient",
 'aff': [u'-',
  u'NASA Kavli space center, Cambridge, MA 02138, USA',
  u'Einsteininstitute, Zurych, Switzerland'],
 'alternate_title': [u'This is of the alternate'],
 'author': [u"t'Hooft, van X", u'Anders, John Michael', u'Einstein, A'],
 'author_count': 3,
 'author_facet': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
 'author_facet_hier': [u'0/T Hooft, V',
  u"1/T Hooft, V/t'Hooft, van X",
  u'0/Anders, J M',
  u'1/Anders, J M/Anders, John Michael',
  u'0/Einstein, A',
  u'1/Einstein, A/Einstein, A'],
 'author_norm': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
 'bibcode': u'testbibcode',
 'bibgroup': [u'Cfa'],
 'bibgroup_facet': [u'Cfa'],
 'bibstem': [u'bibco', u'bibcode'],
 'bibstem_facet': u'bibcode',
 'citation': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'],
 'citation_count': 2,
 'cite_read_boost': 0.52,
 'classic_factor': 5002,
 'database': [u'astronomy', u'physics'],
 'date': u'2013-08-05T00:30:00.000000Z',
 'doctype': u'catalog',
 'doctype_facet_hier': [u'0/Non-Article', u'1/Non-Article/Catalog'],
 'doi': [u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789'],
 'email': [u'-', u'anders@email.com', u'-'],
 'first_author': u"t'Hooft, van X",
 'first_author_facet_hier': [u'0/T Hooft, V', u"1/T Hooft, V/t'Hooft, van X"],
 'first_author_norm': u'T Hooft, V',
 'grant': [u'NASA', u'123456-78', u'NSF-AST', u'0618398'],
 'grant_facet_hier': [u'0/NASA',
  u'1/NASA/123456-78',
  u'0/NSF-AST',
  u'1/NSF-AST/0618398'],
 'id': 99999999,
 'identifier': [u'arxiv:1234.5678',
  u'doi:\xc5\xbd\xc5\xa0\xc4\x8c\xc5\x98\xc4\x8e\xc5\xa4\xc5\x87:123456789',
  u'ARXIV:hep-ph/1234'],
 'issue': u'24i',
 'keyword': [u'Classical Statistical mechanics'],
 'keyword_facet': [u'stat mech'],
 'keyword_norm': [u'stat mech'],
 'keyword_schema': [u'PACS Codes'],
 'links_data': [u'{"access": "", "instances": "78", "title": "", "type": "ned", "url": "http://$NED$/cgi-bin/nph-objsearch?search_type=Search&refcode=2013A%26A...552A.143S"}',
  u'{"access": "open", "instances": "", "title": "", "type": "postscript", "url": "http://www.aanda.org/10.1051/0004-6361/201321247/postscript"}',
  u'{"access": "open", "instances": "", "title": "", "type": "electr", "url": "http://dx.doi.org/10.1051%2F0004-6361%2F201321247"}',
  u'{"access": "", "instances": "74", "title": "", "type": "simbad", "url": "http://$SIMBAD$/simbo.pl?bibcode=2013A%26A...552A.143S"}',
  u'{"access": "open", "instances": "", "title": "", "type": "pdf", "url": "http://www.aanda.org/10.1051/0004-6361/201321247/pdf"}'],
 'nedid': [u'foo bar', u'X+1-5 =6'],
 'nedtype': [u'Other'],
 'ned_object_facet_hier': [u'0/Other',
    u'1/Other/foo bar',
    u'0/Other',
    u'1/Other/X+1-5 =6'],
 'orcid_pub': [u'-', u'-', u'-'],
 'page': [u'2056-2078'],
 'property': [u'OPENACCESS',
  u'OCRABSTRACT',
  u'ADS_OPENACCESS',
  u'NONARTICLE',
  u'NOT REFEREED'],
 'pubdate': u'2013-08-05',
 'read_count': 2,
 'reader': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'],
 'reference': [u'2014JNuM..455...10R'],
 'simbad_object_facet_hier': [u'0/Other',
  u'1/Other/5',
  u'0/Other',
  u'1/Other/3000001'],
 'simbid': [5, 3000001],
 'simbtype': [u'Other'],
 'title': [u'This is of the title', u'This is of the alternate'],
 'volume': u'l24'}

  
# used to check lower level database read code
# data is ingested into postgres so must have all non-nullable fields defined
INPUT_SQL_DOC = [{'bibcode': u'testbibcode2', 'simbad_objects': ['5 type1', '3000001 type2'],
                  'citations': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'],
                  'readers': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'],
                  'grants': [u'NASA 123456-78', 'NSF-AST 0618398'],
                  'norm_cites': u'5002', 'boost': u'0.52'},

                  {'bibcode': u'2000A&AS..143...41K_test', 'simbad_objects': [],
                  'citations': [],'readers': [], 'grants':[],
                   'norm_cites': u'5002', 'boost': u'0.52'},

                  {'bibcode': u'testbibcode3', 'simbad_objects': ['5 type1', '3000001 type2'],
                  'citations': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'],
                  'readers': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'],
                  'grants': [u'NASA 123456-78', 'NSF-AST 0618398'],
                  'norm_cites': u'5002', 'boost': u'0.52'}
                 ]

# used during Solr document generation check, must match values for expected solr doc
INPUT_SQL_SOLR_CHECK = {'bibcode': u'testbibcode2', 'simbad_objects': ['5 type1', '3000001 type2'],
                  'citations': [u'2014JNuM..455...10C', u'2014JNuM..455...10D'],
                  'readers': [u'abaesrwersdlfkjsd', u'asfasdflkjsdfsldj'],
                  'grants': [u'NASA 123456-78', 'NSF-AST 0618398'],
                  'norm_cites': u'5002', 'boost': u'0.52'}

INPUT_SQL_SOLR_CHECK1 = {'bibcode': u'2000A&AS..143...41K_test', 'simbad_objects': [],
                  'citations': [],
                  'readers': [], 'grants':[]}

INPUT_SQL_SOLR_CHECK2 = {'bibcode': u'2014arXiv1406.4542H', 'simbad_objects': [],
                'authors': [u"t'Hooft, van X", u'Anders, John Michael', u'Einstein, A'],
                'citations': [],
                'readers': [],
                'grants': []}


ADSRECORDS = OrderedDict()
_path = os.path.abspath(os.path.join(__file__, '../ADSRecords/'))
for x in os.listdir(_path):
    x = os.path.join(_path, x)
    if not os.path.isfile(x):
        continue
    f = eval(open(x, 'r').read())
    ADSRECORDS[os.path.basename(x)] = f

MERGEDRECS = OrderedDict()
MERGEDRECS['2015ApJ...815..133S'] = {'abstract': u'In order to examine their relation to the host galaxy, the extraplanar dusts of six nearby galaxies are modeled, employing a three-dimensional Monte Carlo radiative transfer code. The targets are from the highly inclined galaxies that show dust-scattered ultraviolet halos, and the archival Galaxy Evolution Explorer FUV band images were fitted with the model. The observed images are generally well-reproduced by two dust layers and one light source layer, whose vertical and radial distributions have exponential profiles. We obtained several important physical parameters, such as star formation rate (SFR<SUB>UV</SUB>), face-on optical depth, and scale-heights. Three galaxies (NGC 891, NGC 3628, and UGC 11794) show clear evidence for the existence of an extraplanar dust layer. However, it is found that the remaining three targets (IC 5249, NGC 24, and NGC 4173) do not necessarily need a thick dust disk to model the ultraviolet (UV) halo, because its contribution is too small and the UV halo may be caused by the wing part of the GALEX point spread function. This indicates that the galaxy samples reported to have UV halos may be contaminated by galaxies with negligible extraplanar (halo) dust. The galaxies showing evidence of an extraplanar dust layer fall within a narrow range on the scatter plots between physical parameters such as SFR<SUB>UV</SUB> and extraplanar dust mass. Several mechanisms that could possibly produce the extraplanar dust are discussed. We also found a hint that the extraplanar dust scale-height might not be much different from the polycyclic aromatic hydrocarbon emission characteristic height.',
 'ack': u'J.H.S. is grateful to Yujin Yang, Dennis Zaritsky, and Ann Zabludoff for their valuable comments and discussion of the results.',
 'aff': [u'Korea Astronomy and Space Science Institute, 776 Daeduk-daero, Yuseong-gu, Daejeon, 305-348, Korea',
  u'Korea Astronomy and Space Science Institute, 776 Daeduk-daero, Yuseong-gu, Daejeon, 305-348, Korea; Astronomy and Space Science Major, Korea University of Science and Technology, 217 Gajeong-ro, Yuseong-gu, Daejeon, 305-350, Korea; Department of Astrophysical Sciences, Princeton University, Princeton NJ 08544, USA'],
 'alternate_bibcode': [u'2015arXiv151103789S'],
 'arxiv_class': [u'Astrophysics - Astrophysics of Galaxies'],
 'author': [u'Shinn, Jong-Ho', u'Seon, Kwang-Il'],
 'author_count': 2,
 'author_facet': [u'Shinn, J', u'Seon, K'],
 'author_facet_hier': [u'0/Shinn, J',
  u'1/Shinn, J/Shinn, Jong-Ho',
  u'0/Seon, K',
  u'1/Seon, K/Seon, Kwang-Il'],
 'author_norm': [u'Shinn, J', u'Seon, K'],
 'bibcode': u'2015ApJ...815..133S',
 'bibstem': [u'ApJ', u'ApJ...815'],
 'bibstem_facet': u'ApJ',
 'citation_count': 0,
 'data': [u'CDS', u'NED'],
 'data_facet': [u'CDS', u'NED'],
 'database': [u'astronomy'],
 'date': u'2015-12-01T00:00:00.000000Z',
 'doctype': u'article',
 'doctype_facet_hier': [u'0/Article', u'1/Article/Journal Article'],
 'doi': [u'10.1088/0004-637X/815/2/133'],
 'eid': u'133',
 'email': [u'jhshinn@kasi.re.kr', u'-'],
 'first_author': u'Shinn, Jong-Ho',
 'first_author_facet_hier': [u'0/Shinn, J', u'1/Shinn, J/Shinn, Jong-Ho'],
 'first_author_norm': u'Shinn, J',
 'identifier': [u'1511.03789',
  u'10.1088/0004-637X/815/2/133',
  u'2015arXiv151103789S'],
 'issue': u'2',
 'keyword': [u'dust',
  u'extinction',
  u'galaxies: halos',
  u'galaxies: ISM',
  u'galaxies: spiral',
  u'galaxies: star formation',
  u'radiative transfer',
  u'Astrophysics - Astrophysics of Galaxies'],
 'keyword_facet': [u'dust',
  u'ism dust extinction',
  u'galaxies halos',
  u'galaxies intergalactic medium',
  u'galaxies spiral',
  u'galaxies star clusters',
  u'radiative transfer'],
 'keyword_norm': [u'dust',
  u'ism dust extinction',
  u'galaxies halos',
  u'galaxies intergalactic medium',
  u'galaxies spiral',
  u'galaxies star clusters',
  u'radiative transfer',
  u'-'],
 'keyword_schema': [u'Astronomy',
  u'Astronomy',
  u'Astronomy',
  u'Astronomy',
  u'Astronomy',
  u'Astronomy',
  u'Astronomy',
  u'arXiv'],
 'links_data': [u'{"access": "", "instances": "7", "title": "", "type": "simbad", "url": "http://$SIMBAD$/simbo.pl?bibcode=2015ApJ...815..133S"}',
  u'{"access": "open", "instances": "", "title": "", "type": "pdf", "url": "http://stacks.iop.org/0004-637X/815/133/pdf"}',
  u'{"access": "", "instances": "6", "title": "", "type": "ned", "url": "http://ned.ipac.caltech.edu/cgi-bin/nph-objsearch?search_type=Search&refcode=2015ApJ...815..133S"}',
  u'{"access": "open", "instances": "", "title": "", "type": "preprint", "url": "http://arxiv.org/abs/1511.03789"}',
  u'{"access": "open", "instances": "", "title": "", "type": "electr", "url": "http://dx.doi.org/10.1088%2F0004-637X%2F815%2F2%2F133"}'],
 'orcid_pub': [u'0000-0001-7967-6473', u'0000-0001-9561-8134'],
 'page': [u'133'],
 'property': [u'OPENACCESS',
  u'REFEREED',
  u'EPRINT_OPENACCESS',
  u'PUB_OPENACCESS',
  u'ARTICLE'],
 'pub': u'The Astrophysical Journal',
 'pub_raw': u'The Astrophysical Journal, Volume 815, Issue 2, article id. 133, <NUMPAGES>14</NUMPAGES> pp. (2015).',
 'pubdate': u'2015-12-00',
 'pubnote': [u'33 pages, 7 figures, 5 tables, ApJ in press; doi:10.1088/0004-637X/815/2/133'],
 'read_count': 0,
 'reference': [u'1941ApJ....93...70H',
  u'1966ApJ...145..811P',
  u'1972A&A....18..253P',
  u'1972MNRAS.159..361C',
  u'1974A&A....35....7P',
  u'1980ApJ...236..577B',
  u'1980ApJS...44...73B',
  u'1981MNRAS.196..455B',
  u'1984A&A...134..158M',
  u'1984A&A...137L...5L',
  u'1986SPIE..627..733T',
  u'1987Natur.327..214G',
  u'1988ApJS...68...91R',
  u'1989A&A...209..349B',
  u'1989ApJS...71..733A',
  u'1990A&A...240..259F',
  u'1990ApJ...352..506H',
  u'1991ApJ...366..443F',
  u'1991ApJ...381..137F',
  u'1992ApJS...83..111W',
  u'1993ASPC...52..173T',
  u'1994AJ....108.1619Z',
  u'1996A&AS..117..393B',
  u'1996PASP..108..699R',
  u'1997AJ....114.2463H',
  u'1998A&A...331..894X',
  u'1998ApJ...498..541K',
  u'1998MNRAS.300.1006D',
  u'1999A&A...344..868X',
  u'1999AJ....117.2077H',
  u'1999ApJS..123....3L',
  u'2000A&AS..145...83A',
  u'2000AJ....119..644H',
  u'2001ApJ...548..296W',
  u'2001ApJ...550..212B',
  u'2003A&A...406..505R',
  u'2003ARA&A..41..241D',
  u'2004A&A...425..109A',
  u'2004AJ....128..662T',
  u'2005ApJ...619L...1M',
  u'2006A&A...445..123I',
  u'2006AJ....131.1163S',
  u'2007AJ....134.1019O',
  u'2007ApJ...668..918B',
  u'2007ApJ...671L..97C',
  u'2007ApJS..173..682M',
  u'2009ApJ...698L.125K',
  u'2009RvMP...81..969H',
  u'2010MNRAS.405.1025M',
  u'2010MNRAS.405.2069M',
  u'2012ApJ...758..109S',
  u'2013A&A...556A..54V',
  u'2013ARA&A..51...63S',
  u'2013ARA&A..51..393C',
  u'2013ApJ...774..126M',
  u'2014A&A...567A..97S',
  u'2014ApJ...785L..18S',
  u'2014ApJ...789..131H',
  u'2014MNRAS.441..869D',
  u'2014Sci...346..905F',
  u'2015A&A...577A.106S',
  u'2015ApJ...813....7P',
  u'2015JKAS...48...57S',
  u'2015arXiv150907677B'],
 'title': [u'Ultraviolet Radiative Transfer Modeling of Nearby Galaxies with Extraplanar Dusts'],
 'volume': u'815',
 'year': u'2015'}
 



INPUT_DOC1={
    "id" : 99999998,
    "modtime" : "2014-11-06T14:11:18.697474Z",
    "bibcode" : u"2000A&AS..143...41K_test",
    "JSON_fingerprint" : "{\"abs\":[{\"p\":\"/proj/ads/abstracts/ast/text/J20/J20-02694.abs\",\"primary\":1,\"t\":\"1317932566\"},{\"p\":\"/proj/ads/abstracts/ast/text/S20/S20-02694.abs\",\"t\":\"1347312274\"}],\"full\":[{\"p\":\"/proj/ads/fulltext/extracted/20/00/A&/AS/,,/14/3,/,,/41/K//meta.json\",\"t\":1395500064},{\"p\":\"/proj/ads/fulltext/extracted/20/00/A&/AS/,,/14/3,/,,/41/K//fulltext.txt\",\"t\":1363680233}],\"links\":{\"electr\":[{\"u\":\"http://dx.doi.org/10.1051%2Faas%3A2000170\"}],\"preprint\":[{\"u\":\"astro-ph/0002104\"}],\"spires\":[{\"u\":\"http://inspirehep.net/search?p=find+j+AAESB,143,41\"}]},\"prop\":[\"bibgroup: CfA\",\"refereed\"],\"refs\":[{\"p\":\"/proj/ads/references/resolved/A+AS/0143/iss1.raw.result\",\"t\":1374540245},{\"p\":\"/proj/ads/references/resolved/AUTHOR/Markus/MarkusMagic.pairs.result\",\"t\":1412026020},{\"p\":\"/proj/ads/references/resolved/ISI/A&AS/A&AS0143.isi.pairs.result\",\"t\":1414726893}]};{\"abs\":[{\"p\":\"/proj/ads/abstracts/pre/text/X00/X00-03262.abs\",\"primary\":1,\"t\":\"1257155059\"}],\"links\":{\"electr\":[{\"u\":\"http://dx.doi.org/10.1051%2Faas%3A2000170\"}],\"preprint\":[{\"u\":\"astro-ph/0002104\"}],\"spires\":[{\"u\":\"http://inspirehep.net/search?p=find+eprint+astro-ph/0002104\"}]},\"prop\":[\"bibgroup: CfA\"],\"refs\":[{\"p\":\"/proj/ads/references/resolved/astro-ph/2000/0002104.raw.result\",\"t\":1360840132}]}",

    "text": {},
    "metadata" : {
    "references": [],
    'properties': {'refereed': True, 'openaccess': False, 
                   'doctype': {'content': u'article', 'origin': u'ADS metadata'}, 
                   'private': False, 'ocrabstract': False, 
                   'ads_openaccess': False,
                   'eprint_openaccess': False,
                   'pub_openaccess': False,
                   'databases': [{'content': u'ast', 'origin': ''}], 
                   'bibgroups': [{'content': u'CfA', 'origin': ''}],
                   'data_sources': [{'content':u'foo','origin':u'bar'},{'content':u'foo2'}],
                   'vizier_tables': [{'content':u'tab1','origin':u'vizier'},{'content':u'tab2'}],
                   },
    "relations": {},
    "general" : {
        "comment" : [ ],
        "doi" : [
            {
                "origin" : u"A&AS",
                "content" : u"10.1051/aas:2000170"
                }
            ],
        "titles" : [
                {
                "lang" : u"en",
                "text" : u"The NASA Astrophysics Data System: Overview"
                }
            ],
        "publication" : {
            "origin" : u"A&AS",
            "dates" : [
                {
                    "content" : u"2000-04-00",
                    "type" : u"date-published"
                    },
                {
                    "content" : u"2000",
                    "type" : u"publication_year"
                    }
                ],
            "name" : {
                "raw" : u"Astronomy and Astrophysics Supplement, v.143, p.41-59",
                "canonical" : u"Astronomy and Astrophysics Supplement Series"
                },
            "page_count" : u"19",
            "page" : u"41",
            "volume" : u"143",
            "page_range" : u"41-59",
            "electronic_id" : u"here is the eid",
            "issue" : None,
            "page_last" : u"59"
            },
        "language" : u"",
        "issns" : [ ],
        "conf_metadata" : {
            "origin" : u"A&AS",
            "content" : None
            },
        "copyright" : [ ],
        "isbns" : [ ],
        "authors" : [
            {
                "name" : {
                    "native" : None,
                    "western" : u"Kurtz, Michael J.",
                    "normalized" : u"Kurtz, M"
                    },
                "number" : u"1",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Eichhorn, Guenther",
                    "normalized" : u"Eichhorn, G"
                    },
                "number" : u"2",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Accomazzi, Alberto",
                    "normalized" : u"Accomazzi, A"
                    },
                "number" : u"3",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : u"0000-0002-4110-3511",
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Grant, Carolyn S.",
                    "normalized" : u"Grant, C"
                    },
                "number" : u"4",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Murray, Stephen S.",
                    "normalized" : u"Murray, S"
                    },
                "number" : u"5",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                },
            {
                "name" : {
                    "native" : None,
                    "western" : u"Watson, Joyce M.",
                    "normalized" : u"Watson, J"
                    },
                "number" : u"6",
                "affiliations" : [
                    u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"
                    ],
                "orcid" : None,
                "type" : u"regular",
                "emails" : [ ]
                }
            ],
        "keywords" : [
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"METHODS: DATA ANALYSIS",
                "channel" : u"",
                "normalized" : u"methods data analysis"
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"ASTRONOMICAL DATABASES: MISCELLANEOUS",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"PUBLICATIONS: BIBLIOGRAPHY",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"A&AS",
                "type" : u"Astronomy",
                "original" : u"SOCIOLOGY OF ASTRONOMY",
                "channel" : u"",
                "normalized" : None
                },
            {
                "origin" : u"ARXIV",
                "type" : u"arXiv",
                "original" : u"Astrophysics",
                "channel" : u"astro-ph",
                "normalized" : u"astrophysics"
                }
            ],
        "arxivcategories" : [
            u"Astrophysics"
            ],
        "pubnote" : [
            {
                "origin" : u"ARXIV",
                "content" : u"19 pages, 22 figures; Astron.Astrophys.Suppl.Ser. 143 (2000) 41-59; doi:10.1051/aas:2000170"
                }
            ],
        "altpublications" : [
            {
                "origin" : u"ARXIV",
                "dates" : [
                    {
                        "content" : u"2000-02-00",
                        "type" : u"date-preprint"
                        },
                    {
                        "content" : u"2000",
                        "type" : u"publication_year"
                        }
                    ],
                "name" : {
                    "raw" : u"eprint arXiv:astro-ph/0002104",
                    "canonical" : u"ArXiv e-prints"
                    },
                "page_count" : None,
                "page" : None,
                "volume" : None,
                "page_range" : None,
                "electronic_id" : u"astro-ph/0002104",
                "altbibcode" : u"2000astro.ph..2104K",
                "issue" : None,
                "page_last" : None
                }
            ],
        }
    }
}

EXPECTED_SOLR_DOC1={
    "first_author": u"Kurtz, Michael J.",
#    "links_data": [u"{\"title\":\"\",\"type\":\"spires\",\"instances\":\"\"}", "{\"title\":\"\",\"type\":\"electr\",\"instances\":\"\"}", "{\"title\":\"\",\"type\":\"spires\",\"instances\":\"\"}"], 
    "first_author_norm": u"Kurtz, M", 
    "year": u"2000", 
    "bibcode": u"2000A&AS..143...41K_test", 
    "author_facet_hier": [
        u"0/Kurtz, M", u"1/Kurtz, M/Kurtz, Michael J.",
        u"0/Eichhorn, G", u"1/Eichhorn, G/Eichhorn, Guenther", 
        u"0/Accomazzi, A", u"1/Accomazzi, A/Accomazzi, Alberto", 
        u"0/Grant, C", u"1/Grant, C/Grant, Carolyn S.", 
        u"0/Murray, S", u"1/Murray, S/Murray, Stephen S.",
        u"0/Watson, J", u"1/Watson, J/Watson, Joyce M."], 
    "bibstem": [u"A&AS", u"A&AS..143"], 
    "aff": [
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA",
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA", 
        u"Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA"], 
    "keyword": [u"METHODS: DATA ANALYSIS", 
                u"ASTRONOMICAL DATABASES: MISCELLANEOUS", 
                u"PUBLICATIONS: BIBLIOGRAPHY", 
                u"SOCIOLOGY OF ASTRONOMY", 
                u"Astrophysics"], 
    "keyword_norm": [u"methods data analysis", u"-", u"-", u"-",
                     u"astrophysics"], 
    "keyword_schema": [u"Astronomy", u"Astronomy",
                       u"Astronomy", u"Astronomy", u"arXiv"], 
    "keyword_facet": [u"methods data analysis",
                      u"astrophysics"], 
    "email": [u"-", u"-", u"-", u"-", u"-", u"-"],
    "orcid_pub": [u"-", u"-", u"0000-0002-4110-3511", u"-", u"-", u"-"],
    'data': [u'foo',u'foo2'],
    'data_facet': [u'foo',u'foo2'],
    "arxiv_class": [u"Astrophysics"], 
    "bibgroup": [u"CfA"],
    "bibgroup_facet": [u"CfA"],
    "author_facet": [u"Kurtz, M", u"Eichhorn, G",
                     u"Accomazzi, A", u"Grant, C", u"Murray, S", u"Watson, J"],
    "bibstem_facet": u"A&AS", 
    "pub": u"Astronomy and Astrophysics Supplement Series", 
    "volume": u"143", 
    "doi": [u"10.1051/aas:2000170"],
    "eid": u"here is the eid",
    "author_norm": [u"Kurtz, M", u"Eichhorn, G", u"Accomazzi, A", u"Grant, C",
                    u"Murray, S", u"Watson, J"], 
    "date": u"2000-04-01T00:00:00.000000Z",
    "pubdate": u"2000-04-00", 
    "id": 99999998,
    "identifier": [u"10.1051/aas:2000170"],
    "database": [u"astronomy"], 
    "author":
        [u"Kurtz, Michael J.", u"Eichhorn, Guenther", u"Accomazzi, Alberto",
         u"Grant, Carolyn S.", u"Murray, Stephen S.", u"Watson, Joyce M."],
    "author_count": 6,
    "citation_count": 0, 
    "pub_raw": u"Astronomy and Astrophysics Supplement, v.143, p.41-59", 
#    "cite_read_boost": 0.45,
    "first_author_facet_hier": [u"0/Kurtz, M", u"1/Kurtz, M/Kurtz, Michael J."], 
    "title": [u"The NASA Astrophysics Data System: Overview"],
    "property": [u"REFEREED", u"ARTICLE"], 
    "page": [u"41",u"here is the eid"],
    'vizier':[u'tab1',u'tab2'],
    'vizier_facet':[u'tab1',u'tab2'],
    "read_count": 0,
    'doctype': u'article',
    'doctype_facet_hier': [u'0/Article', u'1/Article/Journal Article'],
    'pubnote': [u'19 pages, 22 figures; Astron.Astrophys.Suppl.Ser. 143 (2000) 41-59; doi:10.1051/aas:2000170']
}

INPUT_DOC2={
    "id" : 99999997,
    "modtime" : '2014-06-18T21:06:49',
    'bibcode' : u'2014arXiv1406.4542H',
    "text": {},
    "metadata" : {
        "references": [],
        'properties': {'refereed': False, 'openaccess': True, 
                       'doctype': {'content': u'article', 'origin': u'ADS metadata'}, 
                       'private': False, 'ocrabstract': False, 'ads_openaccess':False,
                       'eprint_openaccess': True, 'pub_openaccess': False
                   },
        "relations": {},
        "general" : {
            "publication" : {
                "origin" : u"ARXIV",
                'dates' : [
                    {
                        'type' : u'date-preprint',
                        'content' : u'2014-06-00'
                        }
                    ]
                },
            'authors': [
                {'name': {'normalized': u'T Hooft, V', 'western': u"t'Hooft, van X", 'native': ''}, 
                 'number': u'1', 'affiliations': [], 'orcid': '', 'type': '', 'emails': []}, 
                {'name': {'normalized': u'Anders, J M', 'western': u'Anders, John Michael', 'native': ''}, 
                 'number': u'2', 'affiliations': [u'NASA Kavli space center, Cambridge, MA 02138, USA'], 
                 'orcid': '', 'type': '', 'emails': [u'anders@email.com']}, 
                {'name': {'normalized': u'Einstein, A', 'western': u'Einstein, A', 'native': ''}, 
                 'number': u'3', 'affiliations': [u'Einsteininstitute, Zurych, Switzerland'], 
                 'orcid': '', 'type': '', 'emails': []}],
            }
        },
    'orcid_claims': {'verified': [u'-', u'1111-2222-3333-4444', u'-']}
    }


EXPECTED_SOLR_DOC2={
    "id" : 99999997,
    'bibcode' : u'2014arXiv1406.4542H',
    'date':     u'2014-06-01T00:00:00.000000Z',
    'bibstem': [u'arXiv', u'arXiv1406'],
    'bibstem_facet': u'arXiv',
    'pubdate' : u'2014-06-00',
    "property": [u"OPENACCESS", u"EPRINT_OPENACCESS", u"ARTICLE", u"NOT REFEREED"], 
    "read_count": 0,
    "citation_count": 0,
    'doctype': u'article',
    
    'aff': [u'-',
          u'NASA Kavli space center, Cambridge, MA 02138, USA',
          u'Einsteininstitute, Zurych, Switzerland'],
   'author': [u"t'Hooft, van X", u'Anders, John Michael', u'Einstein, A'],
   'author_facet': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
   'author_facet_hier': [u'0/T Hooft, V',
                         u"1/T Hooft, V/t'Hooft, van X",
                         u'0/Anders, J M',
                         u'1/Anders, J M/Anders, John Michael',
                         u'0/Einstein, A',
                         u'1/Einstein, A/Einstein, A'],
   'author_norm': [u'T Hooft, V', u'Anders, J M', u'Einstein, A'],
    'email': [u'-', u'anders@email.com', u'-'],
    'first_author': u"t'Hooft, van X",
    'first_author_facet_hier': [u'0/T Hooft, V', u"1/T Hooft, V/t'Hooft, van X"],
    'first_author_norm': u'T Hooft, V',
    'orcid_pub': [u'-', u'-', u'-'],
    'orcid_user': [u'-', u'1111-2222-3333-4444', u'-'],
    'author_count': 3,
    'doctype_facet_hier': [u'0/Article', u'1/Article/Journal Article']
}

